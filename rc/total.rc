#!/usr/bin/perl;

use strict;
use warnings;
use IO::All;
use YAML::XS qw/LoadFile DumpFile/;
use Cwd;

$_REPL->load_plugin('DumpHistory');

(my $dir = getcwd) =~ s/^.*\/([^\/]*)$/$1/;
use Grades;
use Grades::Groupwork;
my $l = League->new( leagues => '/home/drbean/051', id => $dir );
my $g = Grades->new({ league => $l });
my $co = Compcomp->new({ league => $l });
my $cl = $g->classwork;
my %m = map { $_->{id} => $_ } @{ $l->members };
my $approach = $l->approach;

# $g->classworkPercent;
# my $two = LoadFile 'classwork/2.yaml';
# my $three = LoadFile 'classwork/4.yaml';
# my $four = LoadFile 'classwork/4.yaml';
# my $five = LoadFile 'classwork/5.yaml';
# my $six = LoadFile 'classwork/6.yaml';
# my $seven = LoadFile 'classwork/7.yaml';
# my $eight = LoadFile 'classwork/8.yaml';
# my %n = map { $m{$_}->{name} => $m{$_} } keys %m;
# $seven;
# my %sevenup = map { $_ => $seven->{$_}->{merits} == 0 ? 0 : $seven->{$_}->{merits} < 30 ? 67 : $seven->{$_}->{merits} < 50 ? 80 : 100 } keys %n;
# $two;
# $four;
# #my %sevenup = map { $_ => $seven->{$_}->{merits} == 0 ? 0 : $seven->{$_}->{merits} < 30 ? 67 : $seven->{$_}->{merits} < 50 ? 80 : 100 } keys %n;
# my %four = map { $_ => $four->{$_}->{merits} == 0 ? 0 : $four->{$_}->{merits} < 50 ? 67 : $four->{$_}->{merits} < 100 ? 80 : 100 } keys %n;
# $five;
# #my %four = map { $_ => $four->{$_}->{merits} == 0 ? 0 : $four->{$_}->{merits} < 50 ? 67 : $four->{$_}->{merits} < 100 ? 80 : 100 } keys %n;
# my %five = map { my $m = $five->{$_}->{merits} ; $_ => $m < 40 ? 67 : $m < 90 ? 80 : 100 } keys %n;
# $six;
# $seven;
# #my %five = map { my $m = $five->{$_}->{merits} ; $_ => $m < 40 ? 67 : $m < 90 ? 80 : 100 } keys %n;
# my %seven = map { my $m = $seven->{$_}->{merits} ; $_ => $m == 0 ? 0 : $m < 40 ? 67 : $m < 50 ? 80 : $m < 60 ? 90 : 100 } keys %n;
# $eight;
# my %total  = map { $n{$_}->{id} => ( $two{$_}->{merits} + $four{$_}->{merits} + $five{$_}->{merits} + $six{$_}->{merits} + $seven{$_}->{merits} + $eight{$_}->{merits} ) / 6 } keys %n;
# $two;
# $six;
# $eight;
# my %total  = map { $n{$_}->{id} => ( $two->{$_}->{merits} + $four{$_}->{merits} + $five{$_}->{merits} + $six->{$_}->{merits} + $seven{$_}->{merits} + $eight->{$_}->{merits} ) / 6 } keys %n;
# $two->{Antonio}->{merits};
# $four{Antonio}->{merits};
# %four;
# my %total  = map { $n{$_}->{id} => ( $two->{$_}->{merits} + $four{$_} + $five{$_}->{merits} + $six->{$_}->{merits} + $seven{$_} + $eight->{$_}->{merits} ) / 6 } keys %n;
# my %total  = map { $n{$_}->{id} => ( $two->{$_}->{merits} + $four{$_}->{merits} + $five{$_}->{merits} + $six->{$_}->{merits} + $seven{$_}->{merits} + $eight->{$_}->{merits} ) / 6 } keys %n;
# my %total  = map { $n{$_}->{id} => ( $two->{$_}->{merits} + $four{$_} + $five{$_} + $six->{$_}->{merits} + $seven{$_} + $eight->{$_}->{merits} ) / 6 } keys %n;
# DumpFile 'classwork/total.yaml', \%total;
# $g->homeworkPercent;
# $g->homeworkPercent;
# $_REPL->load_plugin('DumpHistory');
# :dump total;
# :dump total.rc;
# $g->grades;
my $w0 = LoadFile 'classwork/0.yaml';
my $w1 = LoadFile 'classwork/1.yaml';
my $w2 = LoadFile 'classwork/2.yaml';
my $w3 = LoadFile 'classwork/3.yaml';
my $w4 = LoadFile 'classwork/4.yaml';
my $w5 = LoadFile 'classwork/5.yaml';
my $w6 = LoadFile 'classwork/6.yaml';
my $w7 = LoadFile 'classwork/7.yaml';
my $w8 = LoadFile 'classwork/8.yaml';
my $w10 = LoadFile 'classwork/10.yaml';
my $w11 = LoadFile 'classwork/11.yaml';
my $w12 = LoadFile 'classwork/12.yaml';
my $w13 = LoadFile 'classwork/13.yaml';
my $w14 = LoadFile 'classwork/14.yaml';
my $w15 = LoadFile 'classwork/15.yaml';
my $w16 = LoadFile 'classwork/16.yaml';
my $w17 = LoadFile 'classwork/17.yaml';
my %total = map { $_ => ( $w1->{$_} + $w2->{$_} + $w3->{$_} + $w5->{$_} + $w6->{$_} + $w7->{$_} + $w8->{$_} + $w10->{$_} + $w11->{$_} + $w12->{$_} + $w13->{$_} + $w15->{$_} + $w16->{$_} + $w17->{$_} ) / 11 } keys %m;
DumpFile 'classwork/total.yaml', \%total;
$_REPL->load_plugin('DumpHistory');

# :dump total.rc;
## :dump ~/051/rc/total.rc;
# :dump ../rc/total.rc;
